{% extends "bootstrap/base.html" %}

{% block title %}
Tweet Basic Stats Output ~ Basic
{% endblock title %}

{% block content %}

<div class = "container">
    <div class = "row d-flex justify-content-center">
        <h2 style="text-align: center;">Data (Basic Statistics)</h2>
    </div>

    <form action="{{ url_for('index') }}" method="POST">
            <div class = "card-deck">
                
                <!--Card for generated output-->
                <div class = "card mb-4">
                    <div class = "card-body">                  
                        <h5>Generated Output ID:</h5>
                        <br>
                        <label id = output_id>{{ _id }}</label>
                        <br>
                        <input type = "submit" name = "return" value = "Return to Input">
                    </div>
                </div>

                <!--Card for overall data-->
                <div class = "card mb-4">
                    <div class = "card-body">
                        <h5>Overall Data</h5>
                        <br>
                        <!--Scroll field for the data-->
                        <div style="height:200px;width:250px;border:1px;overflow:auto;">
                            <label id = "overall_data">
                                <Ul>
                                    <li>Total: {{tweets|length}}</li>
                                    {% for loc in locations %}
                                        <li>{{loc}}</li>
                                    {% endfor %}
                                </Ul>
                            </label>
                        </div>
                    </div>
                </div>

                <!--Card for filters-->
                <div class = "card mb-4">
                    <div class = "card-body">         
                        <h5>Filters Used:</h4>
                        <br>
                        <label id = "filters_used">
                        <ul>
                        {% for key, value in filters.items() %}
                        <li>{{ value }}</li>
                        {% endfor %}
                        </ul>
                        </label>
                   </div>
                </div>
            </div>
        
            <div class ="row d-flex justify-content-center">
                <div class = "card mb-4">
                    <div class = "card-body text-center">
                            <h5>Save to File</h5>
                            <label>File Name: </label>
                            <input type = "text" name = "file_name" value = ""><br>
                            <input type = button name = "Save" value = "Save to File">
                    </div>
                </div>
            </div>

            <div class ="row d-flex justify-content-center">
                <div class = "card mb-4">
                    <div class = "card-body">
                        <a class="btn btn-primary" data-toggle="collapse" href="#collapse_filter" id = collapse_button role="button" aria-expanded="false" aria-controls="collapseExample">View Graph</a>
                        <div class="collapse" id="collapse_filter">
                            <canvas id="tweet_barchart" width =200px height=200px></canvas>
                        </div>
                    </div>
                </div>
            </div>
    
        <div class = row>
            <table id="table_tweets" class="table table-striped table-bordered table-sm " cellspacing="0" width="100%">
                <thead>
                    <tr>
                        <th class="th-sm">Tweet ID
                        </th>
                        <th class="th-sm">Profile Name
                        </th>
                        <th class="th-sm">Word Count
                        </th>
                        <th class="th-sm">Follower Count
                        </th>
                        <th class="th-sm">Location
                        </th>
                        <th class="th-sm">Time
                        </th>
                        <th class="th-sm">Likes
                        </th>
                        <th class="th-sm">Retweets
                        </th>
                    </tr>
                </thead>
                <tbody>
                    {% for document in tweets %}
                    <tr>
                        <td>{{ document.tweetID }}</td>
                        <td>{{ document.tweetCreator }}</td>
                        <td>{{ document.tweetText|length }}</td>
                        <td>{{ document.creatorFollowers }}</td>
                        <td>{{ document.location }}</td>
                        <td>{{ document.dateCreated }}</td>
                        <td>{{ document.tweetLikes }}</td>
                        <td>{{ document.tweetRe }}</td>
                     </tr>
                    {% endfor %}
                </tbody>
                <tfoot>
                    <tr>
                        <th>Tweet ID
                        </th>
                        <th>Profile Name
                        </th>
                        <th>Word Count
                        </th>
                        <th>Follower Count
                        </th>
                        <th>Location
                        </th>
                        <th>Time
                        </th>
                        <th>Likes
                        </th>
                        <th>Retweets
                        </th>
                    </tr>
                </tfoot>
            </table>  
        </div>
    </form>
</div>
{% endblock content %}

{% block scripts %}

<!-- JQuery -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<!-- Datatables -->
<script type="text/javascript" src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
<!-- Bootstrap tooltips -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.4/umd/popper.min.js"></script>
<!-- Bootstrap core JavaScript -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.1/js/bootstrap.min.js"></script>
<!-- MDB core JavaScript -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.11.0/js/mdb.min.js"></script>
<script>
    $(document).ready(function () {
    $('#table_tweets').DataTable({
    "scrollX": true,
    "scrollY": 200,
    });
    $('.dataTables_length').addClass('bs-select');
});
</script>

<!-- Toggles the expand state for collapse menu-->
<script>
    $('#collapse_filter').on('hidden.bs.collapse', function () {
    $('#collapse_button').text("View Graph")
    })
</script>

<!--Toggles the collapse state for collapse menu-->
<script>
    $('#collapse_filter').on('show.bs.collapse', function () {
    $('#collapse_button').text("Hide Graph")
    })
</script>

<script>
    var ctxB = document.getElementById("tweet_barchart").getContext('2d');
    var myBarChart = new Chart(ctxB, {
        type: 'bar',
        data: {
        labels: ["Red", "Blue", "Yellow", "Green", "Purple", "Orange"],
        datasets: [{
        label: '# of Votes',
        data: [12, 19, 3, 5, 2, 3],
        backgroundColor: [
        'rgba(255, 99, 132, 0.2)',
        'rgba(54, 162, 235, 0.2)',
        'rgba(255, 206, 86, 0.2)',
        'rgba(75, 192, 192, 0.2)',
        'rgba(153, 102, 255, 0.2)',
        'rgba(255, 159, 64, 0.2)'
        ],
        borderColor: [
        'rgba(255,99,132,1)',
        'rgba(54, 162, 235, 1)',
        'rgba(255, 206, 86, 1)',
        'rgba(75, 192, 192, 1)',
        'rgba(153, 102, 255, 1)',
        'rgba(255, 159, 64, 1)'
        ],
        borderWidth: 1
        }]
        },
        options: {
        scales: {
        yAxes: [{
        ticks: {
        beginAtZero: true
        }
        }]
        }
        }
        });
</script>
{% endblock scripts %}

{% block styles %}
<!-- Font Awesome -->
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
<!-- Google Fonts -->
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap">
<!-- Bootstrap core CSS -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet">
<!-- Material Design Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.11.0/css/mdb.min.css" rel="stylesheet">
<!-- Datatables -->
<link href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">



<style>
    .table_tweetsWrapper{
    max-width: 600px;
    margin: 0 auto;
    }
    #table_tweets th, td {
    white-space: nowrap;
    }
    table.dataTable thead .sorting:after,
    table.dataTable thead .sorting:before,
    table.dataTable thead .sorting_asc:after,
    table.dataTable thead .sorting_asc:before,
    table.dataTable thead .sorting_asc_disabled:after,
    table.dataTable thead .sorting_asc_disabled:before,
    table.dataTable thead .sorting_desc:after,
    table.dataTable thead .sorting_desc:before,
    table.dataTable thead .sorting_desc_disabled:after,
    table.dataTable thead .sorting_desc_disabled:before {
    bottom: .5em;
    }
</style>
{% endblock styles %}